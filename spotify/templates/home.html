{% extends "layout.html" %}

{% block content %}

<div>
  <form action="/replace_playlist" method="post">
    <button>プレイリスト置き換え</button>
  </form>
</div>

<div style="display: flex">
  <div style="margin-right: 40px">
    <h2>tracks</h2>
    <table border="1">
      <thead>
      <tr>
        <th>rank</th>
        <th>name</th>
        <th>artists</th>
        <th>設定</th>
      </tr>
      </thead>
      <tbody>
      {% for track in tracks %}
      <tr class="{{ 'blocked' if track.id in blocking_tracks or blocking_artists|intersect(track.artists|map(attribute='id')) }}">
        <td>{{ loop.index }}</td>
        <td>{{ track.name }}</td>
        <td>{{ track.artists|map(attribute='name')|join(', ') }}</td>
        <td>
          {% if track.id in blocking_tracks %}
          <form action="/tracks/{{ track.id }}/unblock" method="post">
            <button>ブロック解除</button>
          </form>
          {% else %}
          <form action="/tracks/{{ track.id }}/block" method="post">
            <button>ブロック</button>
          </form>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
  <div>
    <h2>artists</h2>
    <table border="1">
      <thead>
      <tr>
        <th>artist</th>
        <th>設定</th>
      </tr>

      </thead>
      <tbody>
      {% for artist in artists %}
      <tr class="{{ 'blocked' if artist.id in blocking_artists }}">
        <td>{{ artist.name }}</td>
        <td>
          {% if artist.id in blocking_artists %}
          <form action="/artists/{{ artist.id }}/unblock" method="post">
            <button>ブロック解除</button>
          </form>
          {% else %}
          <form action="/artists/{{ artist.id }}/block" method="post">
            <button>ブロック</button>
          </form>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
      </tbody>

    </table>
  </div>
</div>
{% endblock %}